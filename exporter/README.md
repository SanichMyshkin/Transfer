# Кастомный мониторинг Nexus 




Сначана пишем какие метрки нам дают
потом пишем структуру 
main.py — точка входа: собирает конфигурацию, инициализирует окружение и запускает задачи.

`metrics/` — набор вычислителей метрик и статусов.

`database/ `— слой доступа к БД и SQL-операциям (подключение, запросы, служебные операции).

`common/` — инфраструктурные вещи (конфигурация, логирование).

`test/` — автотесты (pytest).

В корне — служебные файлы окружения: Dockerfile, makefile, requirements.txt

описываем .env файл


Ключевые папки и файлы

config.py — загрузка и валидация конфигурации приложения (env/файлы/аргументы). [подробности будут уточнены]

logs.py — настройка форматирования и уровней логирования для всего проекта. [подробности будут уточнены]

__init__.py — метка пакета.

cleanup_query.py — операции/скрипты очистки данных в БД (housekeeping). [подробности будут уточнены]

docker_ports.py — обработка/сохранение данных о портах Docker-репозиториев/сервисов. [подробности будут уточнены]

docker_tags.py — чтение/проекция тегов Docker-образов в БД. [подробности будут уточнены]

jobs_reader.py — чтение и подготовка заданий/джоб для обработки. [подробности будут уточнены]

repository_info.py — агрегированная информация о репозиториях для запросов/отчётов. [подробности будут уточнены]

`database/utils/`

connection.py — создание и управление подключением к БД. [подробности будут уточнены]

query_to_db.py — выполнение параметризованных запросов/маппинг результатов. [подробности будут уточнены]


blobs_size.py — вычисление/агрегация размеров blob'ов/артефактов в Nexus. [подробности будут уточнены]

certificates.py — проверка сертификатов (истечение, валидность, связка с репозиториями). [подробности будут уточнены]

docker_ports.py — метрики, связанные с портами/доступностью сервисов Docker-регистри. [подробности будут уточнены]

docker_tags.py — сбор и сравнение тегов Docker-образов (актуальность, количество). [подробности будут уточнены]

repo_size.py — размеры репозиториев/хранилищ. [подробности будут уточнены]

repo_status.py — статусы репозиториев (наличие, доступность, ошибки). [подробности будут уточнены]

tasks.py — реестр и оркестрация задач по сбору метрик. [подробности будут уточнены]

metrics/utils/

api.py — общий клиент для внешних API (HTTP-обёртки, ретраи, аутентификация). [подробности будут уточнены]

api_gitlab.py — клиент GitLab API, если используется связка (например, сопоставление проектов ↔ репозитории). [подробности будут уточнены]

__init__.py — метка пакета.

test_docker_tags.py — тесты логики работы с Docker-тегами (парсинг, фильтрация, агрегация). [подробности будут уточнены]

test_task.py — тесты оркестрации/реестра задач. [подробности будут уточнены]

main.py — точка входа приложения: инициализация конфигурации/логирования, запуск задач. [подробности будут уточнены]

Dockerfile — контейнеризация приложения.

makefile — типовые команды разработки/сборки/тестов.

requirements.txt — зависимости Python.

